{{template "layout" .}}

{{define "content"}}
<div class="project-form-page">
    <header class="page-header">
        <h1>{{if .Edit}}Edit{{else}}New{{end}} Service</h1>
        <a href="{{if .Edit}}/projects/{{.Project.ID}}{{else}}/{{end}}" class="btn btn-secondary">Cancel</a>
    </header>

    {{if .Error}}
    <div class="alert alert-error">
        <span class="alert-icon">⚠️</span>
        {{.Error}}
    </div>
    {{end}}

    <form method="POST" class="project-form card">
        <div class="form-group">
            <label for="name">Service Name</label>
            <input type="text" id="name" name="name" value="{{.Project.Name}}" required pattern="[a-zA-Z0-9_\-]+"
                placeholder="my-app" {{if .Edit}}readonly{{end}}>
            <small>Only letters, numbers, underscores, and hyphens. Cannot be changed later.</small>
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <input type="text" id="description" name="description" value="{{.Project.Description}}"
                placeholder="My awesome application">
        </div>

        <div class="form-group">
            <label for="git_repo_url">Git Repository URL (Optional)</label>
            <input type="text" id="git_repo_url" name="git_repo_url" value="{{.Project.GitRepoURL}}"
                placeholder="https://github.com/user/repo.git">
            <small>Repository will be cloned to the working directory</small>
        </div>

        <div class="form-group">
            <label for="command">Command</label>
            <input type="text" id="command" name="command" value="{{.Project.Command}}" required
                placeholder="/usr/bin/node /app/server.js">
            <small>Full path to the executable and its arguments</small>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="working_dir">Working Directory</label>
                <input type="text" id="working_dir" name="working_dir" value="{{.Project.WorkingDir}}"
                    placeholder="/app">
            </div>

            <div class="form-group">
                <label for="user">Run as User</label>
                <input type="text" id="user" name="user" value="{{.Project.User}}" placeholder="root">
            </div>
        </div>

        <div class="form-group">
            <label for="environment">Environment Variables</label>
            <textarea id="environment" name="environment" rows="4"
                placeholder="NODE_ENV=production&#10;PORT=3000">{{.Project.Environment}}</textarea>
            <small>One per line in KEY=VALUE format</small>
        </div>

        <div class="form-group checkbox-group">
            <label class="checkbox-label">
                <input type="checkbox" name="auto_restart" {{if .Project.AutoRestart}}checked{{end}}>
                <span class="checkbox-custom"></span>
                <span class="checkbox-text">Auto-restart on failure</span>
            </label>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                {{if .Edit}}Update{{else}}Create{{end}} Service
            </button>
        </div>
    </form>
</div>
{{end}}